language: python
python:
  - "2.6"
  - "2.7"
  - "3.2"
  - "3.3"
  - "3.4"
  - "3.5"

# command to install dependencies
install:
  - pwd
  - ls -al `pwd`/*
  - if [[ $TRAVIS_PYTHON_VERSION != '2.6'* ]]; then pip install flake8; else pip install 'flake8<3'; fi
  - pip install travis-sphinx
  - "python ./setup.py install"
 
# command to run tests
script:
    # Run flake8
    - flake8 array_split
    # Run the unittests, cd to docs directory so tests are
    # run on the installed package.
    - cd docs
    - python -m array_split.tests
    - cd ..
    # Build the sphinx documentation using travis-sphinx
    # Can only build docs with sphinx for python 2.6, 2.7, 3.3, 3.4, ..., not python-3.2
    - if [[ $TRAVIS_PYTHON_VERSION != '3.2'* ]]; then travis-sphinx build; fi
    # python doctest on examples.rst
    - cd docs
    - python -m doctest source/examples/examples.rst
    # array_split.__main__ runs doctest on the array_split and array_split.split modules.
    - python -m array_split

after_success:
    # Deploy the travis-sphinx docs to gh-pages using travis-sphinx.
    # Can only build/deploy docs with sphinx for python 2.6, 2.7, 3.3, 3.4, ..., not python-3.2
    - if [[ $TRAVIS_PYTHON_VERSION != '3.2'* ]]; then travis-sphinx --branches=dev deploy; fi

